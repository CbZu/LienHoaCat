<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<% include partials/index_Header.ejs %>
<body>
<div class="container body-content">
    <div class="row">
        <ol class="breadcrumb">
            <a href="/"><i class="icon fa fa-home"></i> Home</a> / <a href="/maintenance-prd?catflt=<%=catflt%>&catId=<%=catId%>"> <%=catflt%></a> / <a href="#">Tạo Sản Phẩm</a>
        </ol>

    </div>
    <div class="row product-info">
        <div class="col-md-4">
            <a href="#" class="thumbnail">
                <img class="img-responsive" src="assets/img/testimonial3.jpg" alt="">
            </a>
        </div>
        <div class="col-md-8">
            <div class="ditem">
                <div class="bs-example bs-example-tabs">
                    <ul id="myTab" class="nav nav-tabs" role="tablist">
                        <li class="active"><a href="#home" role="tab" data-toggle="tab">Sản Phẩm</a></li>
                        <li class=""><a href="#profile" role="tab" data-toggle="tab">Dịch Vụ</a></li>
                    </ul>
                    <div id="myTabContent" class="tab-content">

                        <div class="tab-pane fade active in" id="home">
                            <div class="row">
                                <div class="col-md-8"><h3>Tên Sản Phẩm</h3></div>
                            </div>
                            <div class="row center-block">
                                <input class="col-md-8 form-control" type="text" id="name" onkeyup="CheckPrd()" value=""></input>
                            </div>
                            <div class="row">
                                <div class="col-md-8"><h3>Mã sản phẩm</h3></div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <input class="form-control" type="text" id="newCode" value=""></input>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-8"><h3>Hợp mệnh</h3></div>
                            </div>
                            <div class="row center-block">
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mang0" value="kim"> Kim
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mang1" value="moc"> Mộc
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mang2" value="tuy"> Thủy
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mang3" value="hoa"> Hỏa
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mang4" value="tho"> Thổ
                                    </label>
                            </div>
                            <div class="row">
                                <div class="col-md-8"><h3>Hợp Tuổi</h3></div>
                            </div>
                            <div class="row center-block">
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi0" value="0"> Tý
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi1" value="1"> Sửu
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi2" value="2"> Dần
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi3" value="3"> Mẹo
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi4" value="4"> Thình
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi5" value="5"> Tỵ
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi6" value="6"> Ngọ
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi7" value="7"> Mùi
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi8" value="8"> Thân
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi9" value="9"> Dậu
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi10" value="10"> Tuất
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="Tuoi11" value="11"> Hợi
                                    </label>
                            </div>
                            <div class="row">
                                <div class="col-md-8"><h3>Màu sắc</h3></div>
                            </div>
                            <div class="row center-block">
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau0" value="0"> Đỏ
                                    </label>                                
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau1" value="1"> Tím 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau2" value="2"> Hồng 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau3" value="3"> Vàng 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau4" value="4"> Nâu 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau5" value="5"> Cam 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau6" value="6"> Xám 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau7" value="7"> Ánh vàng 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau8" value="8"> Ánh bạc 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau9" value="9"> Xanh biển 
                                    </label>
                                    
                            </div>
                            <div class="row center-block">
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau10" value="10"> Đen 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau11" value="11"> Xanh lá
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau12" value="12"> Xanh ngọc 
                                    </label>
                                    <label class="checkbox-inline">
                                        <input type="checkbox" id="mau13" value="13"> Trong suốt
                                    </label>
                            </div>
                            <div class="row">
                                <div class="col-md-8"><h3>Size</h3></div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="row">
                                        <label class="col-md-4">
                                            Từ: 
                                        </label>
                                        <div class="col-md-8"><input class="form-control id = "minsize" value = ""></div>                                        
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="row">
                                        <label class="col-md-4">
                                            Đến: 
                                        </label>
                                        <div class="col-md-8"><input class="form-control" id = "maxsize" value = ""></div>                                        
                                    </div>
                                    
                                </div>
                            </div>    
                            
                            <div class="row">
                                <div class="col-md-8"><h3>Phân loại sản phẩm</h3></div>
                            </div>
                            <div class="row center-block">
                                <div class="col-md-2"><h4 style="text-align: center;">Phân loại</h4></div>
                                <div class="col-md-2"><h4 style="text-align: center;">Giá</h4></div>
                                <div class="col-md-3"><h4 style="text-align: center;">Giá sau giảm</h4></div>
                                <div class="col-md-2"><h4 style="text-align: center;">Tồn kho</h4></div>
                                <div class="col-md-3"><h4 style="text-align: center;">Thông tin loại hàng</h4></div>
                            </div>                                                
                            <div class="row" id="rowInsertBtn">
                                <div class="col-md-2">
                                    <button class="btn btn-danger" id='insertBtn' onclick='insert()'>+</button>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div  class="col-md-3">
                                    <input class="form-control newImg"  id = "newImg" type = "file" value = "">
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-2">
                                    <button class="btn btn-primary" id = "add" onclick="Add()">Add</button>
                                </div>
                                <div class="col-md-2">
                                    <a class="btn btn-primary" href = "/" >Cancel</a>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="profile">
                            <div class="col-md-8"><h3>Tên Dịch Vụ</h3></div>
                            <div class="row center-block">
                                <div class="col-md-8">
                                    <input class="col-md-8 form-control" type="text" id="nameDV" onkeyup="CheckPrd()" value=""></input>
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control newImgDv"  id = 'newImgDv' type = 'file' value = ''>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-2">
                                    <button class="btn btn-primary" id = "add" onclick="AddDV()">Add</button>
                                </div>
                                <div class="col-md-2">
                                    <a class="btn btn-primary" href = "/" >Cancel</a>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>

    <br>
    <!--<button  onclick="OpenModal()">
        <i class="fa fa-image" ></i></button>
-->
    <a type="button" onclick="document.getElementById('id02').style.display='block'" style="width:auto;">
        <span class="glyphicon glyphicon-upload"></span>
    </a>
    <!-- Modal -->
    <div id="id02" class="modal">
        <div class="container popup animate">
            <div style="padding-top: 75px;">
                    <span onclick="document.getElementById('id02').style.display='none'" class="close"
                          title="Close Modal">&times;
                    </span>
                <img src="img/LOGO.svg" alt="Avatar" class="avatar center-block" style="max-width: 75px">
            </div>
            <form class="form-horizontal" role="form" action="/login" method="POST">
                <div class="">
                    <h4 class="modal-title">Thêm Hình</h4>
                    <input class="form-control newImgModal"  id = 'newImgModal' type = 'file' value = ''>
                </div>
                <br>
                <button class="center-block btn btn-primary" onclick="CloseModal()" data-dismiss="modal" type="button">Ok</button>
            </form>
        </div>
    </div>


    <div id="modalExpired" class="modal-dialog" style="display: none" role="dialog">


        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Ngày Hết Hạn Khuyến Mãi</h4>
            </div>
            <div class="modal-body">
                <input class="form-control"  id = 'expiredDate' type = 'date' value = ''>
            </div>
            <div class="modal-footer">
                <button type="button" onclick="CloseModalExpired()" class="btn btn-default" data-dismiss="modal">Ok</button>
            </div>
        </div>

    </div>
    <div class="row product-info center-block">
        <div>
            <textarea style="width: 100%; min-height: 300px;" id="description" name="description"></textarea>
        </div>
    </div>

    </div>


</body>
<% include partials/index_Footer.ejs %>
<script src="js/jquery.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/slimmenu.js"></script>
<script src="js/bootstrap-datepicker.js"></script>
<script src="js/bootstrap-timepicker.js"></script>
<script src="js/nicescroll.js"></script>
<script src="js/dropit.js"></script>
<script src="js/ionrangeslider.js"></script>
<script src="js/icheck.js"></script>
<script src="js/fotorama.js"></script>
<script src="js/typeahead.js"></script>
<script src="js/card-payment.js"></script>
<script src="js/magnific.js"></script>
<script src="js/owl-carousel.js"></script>
<script src="js/fitvids.js"></script>
<script src="js/tweet.js"></script>
<script src="js/countdown.js"></script>
<script src="js/gridrotator.js"></script>
<script src="js/custom.js"></script>
<script>
    function CloseModalExpired(){
        document.getElementById('modalExpired').style.display = 'none';
    }

    function CloseModal(){
        var formdata1 = new FormData()
        var input = document.getElementsByClassName("form-control newImgModal")
        for (var i = 0; i < input.length; i++) {
            formdata1.append('images', input[i].files[0]);

        }
        $.ajax({
            url: './ajax/addProductImages',
            type: 'POST',
            data: formdata1,
            async: false,
            cache: false,
            contentType: false,
            enctype: 'multipart/form-data',
            processData: false,
            success: function (response) {
                $.ajax({
                    type: "POST",
                    url: "./PetMart/remove",
                    data: "path=" + response.path,
                    success: function (msg) {
                        //alert(msg);
                        data = msg;
                        var description = document.getElementById("description").value;
                        description +=  '<br>'+'<img border=0 hspace="0" alt="" src="assets/img/'+response.image+'" align="baseline" class="img-responsive">' + '<br>';
                        document.getElementById("description").value = description;
                        document.getElementById("id02").style.display = 'none';

                    }
                });

            }
        });

    }
    function insert() {
        var element = '<div class="row center-block">\n' +
            '                            \n' +
            '                            <div class="col-md-2"><input class="form-control" id = \'productType\' value = \'\'>\n' +
            '\n' +
            '                            </input></div>\n' +
            '\n' +
            '                            <div class="col-md-2"><input class="form-control" id = \'newPrice\' value = \'\'>\n' +
            '\n' +
            '                            </input></div>\n' +
            '                            <div class="col-md-3" ><input class="form-control" id = \'newDisc\' value = \'\'>\n' +
            '\n' +
            '                            </input></div>\n' +
            '\n' +
            '                           <div class="col-md-2"><input class="form-control" id = \'remaining\' value = \'\'>\n' +
            '\n' +
            '                            </input></div>\n' +
            '\n' +
            '                            <div  class="col-md-3"><input class="form-control"  id = \'infor\' value = \'\'>\n' +
            '\n' +
            '                            </input></div>\n' +
            '                        </div><br>';
        $(element).insertBefore($('#rowInsertBtn'));
    }

    function Add() {
        var formdata = new FormData();
        var obj =$("#name");
        $(".error").remove();
        $.ajax({
            type: "POST",
            url: "./ajax/checkProduct",
            data: "mode=check_email&name=" + obj.val(),
            success: function (msg) {
                //alert(msg);
                data = msg;
                if (data.status == 'exist') {
                    obj.after("<label class='error'>Product Name Aleady Exist</label>");
                    document.getElementById('add').style.display = 'none'
                    return;
                }
                else {
                    document.getElementById('add').style.display = 'block'
                }
            }
        });

        var input = document.getElementsByClassName("form-control newImg")
        for (var i = 0; i < input.length; i++) {
            formdata.append('upfiles', input[i].files[0]);

        }
        var allElements = document.getElementsByTagName("input");
        var sizes = new Array();
        var prices = new Array();
        var disct_prices = new Array();
        var codes = new Array();
        var description = document.getElementById("description").value;
        formdata.append('description', description);
        var name = document.getElementById("name").value;
        formdata.append('name', name);
        var category = '<%= catId %>';
        formdata.append('category', category);
        for (var i = 0; i < allElements.length; i++) {
            if (allElements[i].id == 'newSize') {
                sizes.push(allElements[i].value);
            }
            if (allElements[i].id == 'newPrice') {
                prices.push(allElements[i].value);
            }
            if (allElements[i].id == 'newDisc') {
                if(allElements[i].value.trim()=='0'){
                    disct_prices.push(allElements[i].value);
                }else{
                    if(document.getElementById('expiredDate').value.trim() == ''){
                        document.getElementById('modalExpired').style.display = 'block';
                        return false;
                    }else{
                        disct_prices.push(allElements[i].value);
                    }
                }

            }
            if (allElements[i].id == 'newCode') {
                codes.push(allElements[i].value);
            }
        }
        var expd = document.getElementById('expiredDate').value;
        formdata.append('expired_date', expd.replace(/-/g, ""));
        formdata.append('Sizes', sizes);
        formdata.append('Prices', prices);
        formdata.append('Discounts', disct_prices);
        formdata.append('Codes', codes);


        $.ajax({
            url: './ajax/addProduct',
            type: 'POST',
            data: formdata,
            async: false,
            cache: false,
            contentType: false,
            enctype: 'multipart/form-data',
            processData: false,
            success: function (response) {
                $.ajax({
                    type: "POST",
                    url: "./PetMart/remove",
                    data: "path=" + response.path,
                    success: function (msg) {
                        //alert(msg);
                        data = msg;

                        location.reload();

                    }
                });
            }
        });


        /*$.ajax({
            type: "POST",
            url: "./ajax/addProduct",
            data: "mode=data&Sizes=" + sizes+"&Prices="+prices+"&Discounts="+disct_prices+"&description="+description+"&name="+name+"&category="+category+"&Codes="+codes+"&Images="+images,
            success: function (msg) {
                //alert(msg);
                data = msg;
                $.ajax({
                    type: "POST",
                    url: "./ajax/addProduct",
                    data: "mode=data&Ids="+data.ids+"&Images="+images,
                    success: function (msg) {
                        //alert(msg);
                        data = msg;

                        location.reload();

                    }
                });
                location.reload();

            }
        });*/
    }
    function OpenModal(){
        document.getElementById('myModal').style.display = 'block';
    }
    function AddDV() {
        var formdata = new FormData();
        var obj =$("#name");
        $(".error").remove();
        $.ajax({
            type: "POST",
            url: "./ajax/checkProduct",
            data: "mode=check_email&name=" + obj.val(),
            success: function (msg) {
                //alert(msg);
                data = msg;
                if (data.status == 'exist') {
                    obj.after("<label class='error'>Product Name Aleady Exist</label>");
                    document.getElementById('add').style.display = 'none'
                    return;
                }
                else {
                    document.getElementById('add').style.display = 'block'
                }
            }
        });

        var input = document.getElementsByClassName("form-control newImgDv")
        for (var i = 0; i < input.length; i++) {
            formdata.append('upfiles', input[i].files[0]);

        }
        var allElements = document.getElementsByTagName("input");
        var sizes = new Array();
        var prices = new Array();
        var disct_prices = new Array();
        var codes = new Array();
        var description = document.getElementById("description").value;
        formdata.append('description', description);
        var name = document.getElementById("nameDV").value;
        formdata.append('name', name);
        var category = '<%= catId %>';
        formdata.append('category', category);
        for (var i = 0; i < allElements.length; i++) {
            if (allElements[i].id == 'newSize') {
                sizes.push(allElements[i].value);
            }
            if (allElements[i].id == 'newPrice') {
                prices.push(allElements[i].value);
            }
            if (allElements[i].id == 'newDisc') {
                if(allElements[i].value.trim()=='0'){
                    disct_prices.push(allElements[i].value);
                }else{
                    if(document.getElementById('expiredDate').value.trim() == ''){
                        document.getElementById('modalExpired').style.display = 'block';
                        return false;
                    }else{
                        disct_prices.push(allElements[i].value);
                    }
                }

            }
            if (allElements[i].id == 'newCode') {
                codes.push(allElements[i].value);
            }
        }
        var expd = document.getElementById('expiredDate').value;
        formdata.append('expired_date', expd.replace(/-/g, ""));
        formdata.append('Sizes', sizes);
        formdata.append('Prices', prices);
        formdata.append('Discounts', disct_prices);
        formdata.append('Codes', codes);


        $.ajax({
            url: './ajax/addProduct',
            type: 'POST',
            data: formdata,
            async: false,
            cache: false,
            contentType: false,
            enctype: 'multipart/form-data',
            processData: false,
            success: function (response) {
                $.ajax({
                    type: "POST",
                    url: "./PetMart/remove",
                    data: "path=" + response.path,
                    success: function (msg) {
                        //alert(msg);
                        data = msg;

                        location.reload();

                    }
                });
            }
        });


        /*$.ajax({
            type: "POST",
            url: "./ajax/addProduct",
            data: "mode=data&Sizes=" + sizes+"&Prices="+prices+"&Discounts="+disct_prices+"&description="+description+"&name="+name+"&category="+category+"&Codes="+codes+"&Images="+images,
            success: function (msg) {
                //alert(msg);
                data = msg;
                $.ajax({
                    type: "POST",
                    url: "./ajax/addProduct",
                    data: "mode=data&Ids="+data.ids+"&Images="+images,
                    success: function (msg) {
                        //alert(msg);
                        data = msg;

                        location.reload();

                    }
                });
                location.reload();

            }
        });*/
    }
</script>
<script>

     function CheckPrd() {
            var obj =$("#name");
         $(".error").remove();
            $.ajax({
                type: "POST",
                url: "./ajax/checkProduct",
                data: "mode=check_email&name=" + obj.val(),
                success: function (msg) {
                    //alert(msg);
                    data = msg;
                    if (data.status == 'exist') {
                        obj.after("<label class='error'>Product Name Aleady Exist</label>");
                        document.getElementById('add').style.display = 'none'
                    }
                    else {
                        document.getElementById('add').style.display = 'block'
                    }
                }
            });
        }



</script>
</html>